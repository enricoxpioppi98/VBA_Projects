Sub Format_SUB()

    Improve_Execution.ScreenUpdating_And_Calculation

    'Add top and left medium black border to selected range
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With

    'Highlight in yellow the first row of the selected range
    Range("B" & Selection.Rows(1).Row & ":C" & Selection.Rows(1).Row).Interior.Color = 65535

    'Bold and center the second column of the first row of the selected range
    With Range("C" & Selection.Rows(1).Row)
        .Font.Bold = True
        .HorizontalAlignment = xlCenter
    End With

    'For each cell in the first column of the selected range,
    'if the alignment is not right,
    'increase by 1 the indentation level
    For Each cell In Range("B" & Selection.Rows(1).Row & ":B" & Selection.Rows(1).Row + Selection.Rows.Count - 1)
        If cell.HorizontalAlignment <> xlRight Then
            cell.InsertIndent 1
        End If
    Next cell

    'The first cell of the first column should be one indentation level less than all other cells in the first column
    Range("B" & Selection.Rows(1).Row).IndentLevel = Range("B" & Selection.Rows(2).Row).IndentLevel - 1

    Improve_Execution.Restore

End Sub

