Sub GM_1804()

    Improve_Execution.ScreenUpdating_And_Calculation

    'Books ------------------------------------------------------------------------------------------------------------------------------------------
        Set GCM = ActiveWorkbook    
        Set Current_Part = GCM.ActiveSheet

        'If Current Tab Is NOT a part, exit Sub -----------------------------------------------------------------------------------------------------
            If Custom_Function.Is_A_Part_Tab(Current_Part, GCM, True) = False Then
                Improve_Execution.Restore
                MsgBox "Please run this macro in a part tab."
                Exit Sub
            End If
        '--------------------------------------------------------------------------------------------------------------------------------------------

        Set CBD = Workbooks.Open(Application.GetOpenFilename(Title:="Please, select the 1804 template."))
    '------------------------------------------------------------------------------------------------------------------------------------------------

    'Transfer Previous Sell Price -------------------------------------------------------------------------------------------------------------------
        CBD.Worksheets("sheet1").Range("D314").Value = CBD.Worksheets("sheet1").Range("Y323").Value
    '------------------------------------------------------------------------------------------------------------------------------------------------

    'Material ---------------------------------------------------------------------------------------------------------------------------------------
        'Copy and Paste -----------------------------------------------------------------------------------------------------------------------------
            'Find last row in GCM BOM ---------------------------------------------------------------------------------------------------------------
                'Starting from row 266 and going up, find the first cell that is different from ""
                For BOM_Last_Row = 266 To 17 Step -1
                    If Current_Part.Range("A" & BOM_Last_Row).Value <> "" Then
                        Exit For
                    End If
                Next BOM_Last_Row
            '----------------------------------------------------------------------------------------------------------------------------------------
            'Description ----------------------------------------------------------------------------------------------------------------------------
                Current_Part.Range("AC17:AC" & BOM_Last_Row).Copy
                CBD.Worksheets("Sheet1").Range("B19").PasteSpecial Paste:=xlPasteValues
            '----------------------------------------------------------------------------------------------------------------------------------------
            'Type -----------------------------------------------------------------------------------------------------------------------------------
                Current_Part.Range("AD17:AD" & BOM_Last_Row).Copy
                CBD.Worksheets("Sheet1").Range("F19").PasteSpecial Paste:=xlPasteValues
            '----------------------------------------------------------------------------------------------------------------------------------------
            'Unit -----------------------------------------------------------------------------------------------------------------------------------
                Current_Part.Range("I17:I" & BOM_Last_Row).Copy
                CBD.Worksheets("Sheet1").Range("J19").PasteSpecial Paste:=xlPasteValues
            '----------------------------------------------------------------------------------------------------------------------------------------
            'Quantity -------------------------------------------------------------------------------------------------------------------------------
                Current_Part.Range("AE17:AE" & BOM_Last_Row).Copy
                CBD.Worksheets("Sheet1").Range("L19").PasteSpecial Paste:=xlPasteValues 
            '----------------------------------------------------------------------------------------------------------------------------------------
            'Unit Cost ------------------------------------------------------------------------------------------------------------------------------
                Current_Part.Range("AG17:AG" & BOM_Last_Row).Copy
                CBD.Worksheets("Sheet1").Range("N19").PasteSpecial Paste:=xlPasteValues 
            '----------------------------------------------------------------------------------------------------------------------------------------
        '--------------------------------------------------------------------------------------------------------------------------------------------
        'Remove Empty Rows in CBD -------------------------------------------------------------------------------------------------------------------
            Number_Of_Parts_in_BOM = BOM_Last_Row - 16
            
            If Number_Of_Parts_in_BOM > 0 Then
                If Number_Of_Parts_in_BOM < 265 Then
                    'in CBD, delete rows from 18 + Number Of Parts in BOM to 266
                    CBD.Worksheets("Sheet1").Rows((18 + Number_Of_Parts_in_BOM + 2) & ":276").Delete
                End If
            Else
                Improve_Execution.Restore
                MsgBox "Couldn't find any parts in the BOM."
                Exit Sub
            End If
        '--------------------------------------------------------------------------------------------------------------------------------------------
    '------------------------------------------------------------------------------------------------------------------------------------------------

    'Save As and Rename

    Improve_Execution.Restore

End Sub